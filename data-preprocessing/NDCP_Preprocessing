import pandas as pd
import numpy as np

df = pd.read_excel('NDCP2022.xlsx')

selected_columns = ['STATE_NAME','COUNTY_NAME','COUNTY_FIPS_CODE','STUDYYEAR','MCINFANT', 'MCTODDLER', 'MCPRESCHOOL','MFCCINFANT', 'MFCCTODDLER', 'MFCCPRESCHOOL',
'MHI','MFI']
childcare_data = df[selected_columns]
childcare_data = childcare_data[childcare_data['STUDYYEAR'] == 2022]

#Explanation of column names: 
# MCInfant: Median Weekly Price of Center-Based Care – Infant 
# MCToddler: Median Weekly Price of Center-Based Care – Toddler
# MCPreschool: Median Weekly Price of Center-Based Care – Preschool
# MFCCInfant: Median Weekly Price of Family Child Care – Infant
# MFCCToddler: Median Weekly Price of Family Child Care – Toddler
# MFCCPreschool: Median Weekly Price of Family Child Care – Preschool

# Rename columns for clarity
childcare_data.rename(columns={
    'MHI': 'Median_Household_Income',
    'MFI': 'Median_Family_Income'
}, inplace=True)

childcare_data.drop('STUDYYEAR', axis=1, inplace=True)

childcare_data['Weighted_Center_Price'] = (childcare_data['MCINFANT']*24 + childcare_data['MCTODDLER']*12 + childcare_data['MCPRESCHOOL']*18) / 54
childcare_data['Weighted_Family_Care_Price'] = (childcare_data['MFCCINFANT']*24 + childcare_data['MFCCTODDLER']*12 + childcare_data['MFCCPRESCHOOL']*18) / 54

childcare_data.to_csv('NDCP_Processed_Data.csv', index=False)